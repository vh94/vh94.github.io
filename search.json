[
  {
    "objectID": "Rprogramming.html",
    "href": "Rprogramming.html",
    "title": "R Programming",
    "section": "",
    "text": "M_ind converts between single matrix index and x,y indices\n\n# convert single index v_i to i,j \nM_ind <- function(v_i) {\n  i = 9 # dim of sudoku\n  i_m = ifelse(v_i%%i,v_i%%i,i)\n  return(c(i_m,ceiling(v_i/i)))\n}\n\nGetting the 3x3 “boxes” of the sudoku:\n\n# create boxes\nboxes <- matrix(\n  sapply(list(1:3,4:6,7:9),rep,3,each=3),\n  9,byrow = TRUE\n)\n\n\n\n\nChecking if the number at x,y is unique in its row, column and box.\n\nis_valid <- function(X,Y,board,boxes) {\n  box   <- boxes[X,Y] \n  if (any(duplicated(board[X,],incomparables = 0))) {\n    return(FALSE)\n  } else if (any(duplicated(board[,Y],incomparables = 0))) {\n    return(FALSE)\n  } else if (any(duplicated(board[boxes==box],incomparables = 0))){\n    return(FALSE)\n  } else {\n    return(TRUE)\n  } \n}\n\nNow the depth first search algorithm.\n\nsolve_sudoku <- function(sudoku) {\n  empty = which(sudoku == 0) # obtain empty pos\n  S = length(empty) + 1      # steps\n  N = 1                      # Step\n  while (N < S) {\n    i = M_ind(empty[N])      # row; col index of empty pos\n    while (TRUE) {\n    sudoku[empty[N]] = sudoku[empty[N]] + 1\n    check = is_valid(X=i[1],Y=i[2],board=sudoku,boxes = boxes) \n    if(sudoku[empty[N]] > 9){\n        sudoku[empty[N]] = 0 # reset\n        N = N - 1            # go back\n        break\n      }\n    if(check) {\n        N = N + 1           # proceed\n        break\n      }\n    }\n  }\n  return(sudoku)\n}\n\n\n\n\n\n\n\nLets test the implementation on three example sudoku with increasing difficulty\n\n\n\n\n\n \n \n\n6\n5\n2\n\n\n\n9\n\n\n\n\n\n\n\n\n6\n\n\n\n8\n\n\n\n9\n\n2\n\n\n\n7\n\n \n \n\n2\n\n9\n3\n\n1\n\n\n\n\n\n1\n\n7\n\n5\n\n3\n\n4\n\n\n\n\n\n4\n\n9\n8\n\n2\n \n \n\n\n6\n\n\n\n7\n\n2\n\n\n\n3\n\n\n\n9\n\n\n\n\n\n\n\n\n4\n\n\n\n6\n5\n9\n\n\n\n\n\n\n\n \n \n\n\n\n1\n\n\n5\n8\n\n\n\n\n2\n8\n\n\n\n3\n\n7\n\n\n\n\n\n\n4\n2\n\n\n\n\n \n \n\n\n1\n\n\n\n\n\n\n\n\n\n\n\n\n\n5\n\n\n4\n\n\n\n8\n3\n\n9\n\n\n5\n\n\n \n \n\n9\n5\n\n3\n\n\n4\n\n\n\n\n\n\n\n\n\n7\n\n\n6\n\n\n\n\n2\n\n\n\n\n\n\n\n\n\n\n\n\n\n \n \n\n\n\n5\n3\n\n\n\n\n\n\n\n8\n\n\n\n\n\n\n2\n\n\n\n\n7\n\n\n1\n\n5\n\n\n \n \n\n4\n\n\n\n\n5\n3\n\n\n\n\n\n1\n\n\n7\n\n\n\n6\n\n\n\n\n3\n2\n\n\n\n8\n\n \n \n\n\n6\n\n5\n\n\n\n\n9\n\n\n\n\n4\n\n\n\n\n3\n\n\n\n\n\n\n\n\n9\n7\n\n\n\n\n\n\n\n\nThe left one is rather easy, the middle one medium and the right one is made by the Finnish Mathematician Inkala and is very hard to solve.\nLets run it:\n\n\n\n\n\n \n \n\n6\n5\n2\n7\n3\n8\n9\n4\n1\n\n\n4\n7\n1\n9\n6\n5\n2\n3\n8\n\n\n8\n9\n3\n2\n1\n4\n5\n7\n6\n \n \n\n2\n4\n9\n3\n8\n1\n7\n6\n5\n\n\n1\n8\n7\n6\n5\n2\n3\n9\n4\n\n\n5\n3\n6\n4\n7\n9\n8\n1\n2\n \n \n\n9\n6\n8\n5\n4\n7\n1\n2\n3\n\n\n3\n2\n5\n1\n9\n6\n4\n8\n7\n\n\n7\n1\n4\n8\n2\n3\n6\n5\n9\n\n\n\n\n\n\n\n \n \n\n4\n9\n1\n7\n6\n5\n8\n3\n2\n\n\n2\n8\n5\n1\n9\n3\n6\n7\n4\n\n\n3\n7\n6\n4\n2\n8\n1\n9\n5\n \n \n\n5\n1\n7\n6\n3\n4\n2\n8\n9\n\n\n6\n2\n9\n8\n5\n1\n7\n4\n3\n\n\n8\n3\n4\n9\n7\n2\n5\n6\n1\n \n \n\n9\n5\n8\n3\n1\n6\n4\n2\n7\n\n\n1\n4\n3\n2\n8\n7\n9\n5\n6\n\n\n7\n6\n2\n5\n4\n9\n3\n1\n8\n\n\n\n\n\n\n\n \n \n\n1\n4\n5\n3\n2\n7\n6\n9\n8\n\n\n8\n3\n9\n6\n5\n4\n1\n2\n7\n\n\n6\n7\n2\n9\n1\n8\n5\n4\n3\n \n \n\n4\n9\n6\n1\n8\n5\n3\n7\n2\n\n\n2\n1\n8\n4\n7\n3\n9\n5\n6\n\n\n7\n5\n3\n2\n9\n6\n4\n8\n1\n \n \n\n3\n6\n7\n5\n4\n2\n8\n1\n9\n\n\n9\n8\n4\n7\n6\n1\n2\n3\n5\n\n\n5\n2\n1\n8\n3\n9\n7\n6\n4\n\n\n\n\n\n\nwe get the solution to all three lvls of sudoku!\nHow long did this approach take to come up with the solutions?\n\nmicrobenchmark::microbenchmark(\n  solve_sudoku(easy),\n  solve_sudoku(medium),\n  solve_sudoku(Inkala),\n  times = 1\n)\n\nUnit: milliseconds\n                 expr        min         lq       mean     median         uq        max neval\n   solve_sudoku(easy)   48.09263   48.09263   48.09263   48.09263   48.09263   48.09263     1\n solve_sudoku(medium)  157.14338  157.14338  157.14338  157.14338  157.14338  157.14338     1\n solve_sudoku(Inkala) 2770.19387 2770.19387 2770.19387 2770.19387 2770.19387 2770.19387     1\n\n\nThats it!"
  },
  {
    "objectID": "about.html",
    "href": "about.html",
    "title": "About",
    "section": "",
    "text": "About this site"
  },
  {
    "objectID": "shinylive.html",
    "href": "shinylive.html",
    "title": "Conway’s Game of live",
    "section": "",
    "text": "Conways game of life is a basic cellular automata simulation. In this gridbased simulation the state of a cell, dead or alive, is defined by the number of its direct neigbors:\nShinylive"
  },
  {
    "objectID": "shinylive.html#python-implementation",
    "href": "shinylive.html#python-implementation",
    "title": "Conway’s Game of live",
    "section": "Python Implementation",
    "text": "Python Implementation\nThe function create_grid returns a 2d array of specified dimensions.\n\ndef create_grid(xdim,ydim):return( [[x]*xdim for x in [0]* ydim] )\n\nTo count living cells in the neighbourhood of all cells the function neighbors creates an other grid that stores the counts for each cell in the grid.\n\ndef neigbors(grid):\n  neib = create_grid(xdim,ydim)\n  for i in range(ydim):\n    for j in range(xdim):\n      for y in range(i-1,i+2):\n        for x in range(j-1,j+2):\n          neib[i][j] += grid[y%ydim][x%xdim]\n      neib[i][j] = neib[i][j]-grid[i][j]\n  return(neib)\n\nThe step function iterates through the grid and gives birth or kills cells based oon their neigbourhood.\n\ndef step(grid):\n  neibs = neigbors(grid)\n  for i in range(ydim):\n    for j in range(xdim):\n      if grid[i][j] == 1:\n        if neibs[i][j] in [2,3]:\n          grid[i][j] = 1\n        else:\n          grid[i][j] = 0\n      else:\n        if neibs[i][j] == 3:\n          grid[i][j] = 1\n  return(grid)\n\nTo populate our World the populate fuction adds living cells at defined locations in the grid, specified by an array of coordinate tuples.\n\ndef populate(grid,coord_array):\n    coord_range = [(y, x) for y in range(ydim) for x in range(xdim)] \n    for (y,x) in coord_range:\n        if (y,x) in coord_array:\n            grid[y][x]=1\n    return(grid)\n\nThe coord_array are stored in a dict called creatures:\n\n\nCode\ncreatures = {\n  \"glider\" : [(0,1),(1,2),(2,0),(2,1),(2,2),(10,1),(11,2),(12,0),(12,1),(12,2)],\n  \"blinker\" : [(10,10),(10,11),(10,12)],\n  \"ggun\" :[(5,1),(5,2),(6,1),(6,2),(5,11),(6,11),(7,11),(4,12),(8,12),(3,13),(9,13),\n  (3,14),(9,14),(6,15),(4,16),(8,16),(5,17),(6,17),(7,17),(6,18),(3,21),(4,21),\n  (5,21),(3,22),(4,22),(5,22),(2,23),(6,23),(2,25),(7,25),(1,25),(6,25),(3,35),(4,35),(3,36),(4,36)]\n}\n\n\nTo obtain a quick visualisation of the world, the Vis function creates a string from the grid.\n\ndef Vis(grid):\n    vis = str()\n    for y in range(ydim):\n        for x in range(xdim):\n            if grid[y][x] == 0: vis += '░' \n            else: vis += '█'\n        vis += '\\n'\n    return vis\n\nFinally the main function runs the simualtion loop and returns the visualisation.\n\ndef main(xdim,ydim,steps,creature):\n    grid = create_grid(xdim,ydim)\n    visus = []\n    populate(grid,creatures[creature])\n    for s in range(1,steps):\n        visus.append(Vis(step(grid)))\n    return(visus)"
  },
  {
    "objectID": "index.html",
    "href": "index.html",
    "title": "VH",
    "section": "",
    "text": "This is a personal Website containing thoughts about biology, programming and statistics.\n\n\n\nThe page is realized with quarto and hosted via github."
  },
  {
    "objectID": "Bioinfo.html#needlemanwunsch",
    "href": "Bioinfo.html#needlemanwunsch",
    "title": "Bioinformatics",
    "section": "Needleman–Wunsch",
    "text": "Needleman–Wunsch\nNeedleman–Wunsch algorithm from the 70’s was used to align two protein or nucleotide sequences. Here is an iterative version of the algorithm I implemented as a homework exercise last year.\nThe algorithm uses a scoring system to find the optimal alignment of the two sequences. The most basic version of a scoring system is:\n\n+1 for a match\n-1 for a mismatch\n-2 for a gap ( indel )\n\n\nImplementation\nThe algorithm works as follows:\nFirst two empty matrices are created with the dimensions of sequence 1 and 2 (rows/columns). The first matrix matwill hold the highest possible score, the other matrix pathmat will hold the position from which field the highest score came from. We then iterate forward through both of the sequences, calculate the scores at each position, and save the highest score at each position to mat, and where it came from to pathmat. Last we traceback (i.e. iterate backwards from bottom right to top left) through the pathmat according to where we came from (i.e. 0: match/mismatch -> go up&left; 1: insertion -> go left; 2: deletion -> go up.) and build our sequence alignment accordingly.\n\n\nScoring function\n\nimport numpy as np\n\ndef scoring(s1,s2,match,gap,mismatch):\n  l1 = len(s1)+1\n  l2 = len(s2)+1\n  mat = np.zeros((l1,l2),dtype= int)  # for score\n  pathmat = np.zeros((l1,l2),dtype= int) # for traceback\n  mat[:,0] = [ i *gap for i in range(l1)]# fill first col \n  mat[0,:] = [ j *gap for j in range(l2)]# fill first row\n  for i in range(1,l1):\n    for j in range(1,l2):\n      n=[] # save scores for position \n      n.append(mat[i-1,j-1] + (s1[i-1] == s2[j-1])*match +(s1[i-1] != s2[j-1])*mismatch )# match\n      n.append(mat[i,j-1] + gap)  # insertion\n      n.append(mat[i-1,j] + gap)  # deletion\n      mat[i,j] = max(n) # keep maximal score \n      pathmat[i,j] = np.argmax(n) # keep position\n  return(pathmat)\n\n\n\nTraceback Function\nIn the next step we define a function that traces back through the pathmat matrix and check the value in the field, checking from which field the highest score stems from.\n\ndef traceback(s1,s2,pathmat):\n  i = len(s1)\n  j = len(s2)\n  ref = [] # alignment for seq 1\n  read = [] # alignment for seq 2\n  while i and j != 0:\n    if pathmat[i, j] == 0:\n      ref.append(s1[i-1])\n      read.append(s2[j-1])\n      i -= 1 #\n      j -= 1 # go to upper left\n    elif pathmat[i, j] == 1:\n      ref.append('-')\n      read.append(s2[j-1])\n      j -= 1 # go left\n    elif pathmat[i, j] == 2:\n      ref.append(s1[i-1])\n      read.append('-')\n      i -= 1 # go up\n  return([ref,read])\n\nThis returns the objects ref the reference sequence, aligned to the readthe read.\n\n\nPrint Alignment\nSo lets define a simple text output function to print the alignments\n\ndef PrintAlignment(ref,read):\n  rmatch = [\"|\" if ref[i] == read[i] else \" \" for i in range(len(ref))]\n  ref = \"\".join(ref)[::-1] # reference seq\n  mid =  \"\".join(rmatch)[::-1]\n  read =  \"\".join(read)[::-1] # read seq\n  for i in range(80,len(mid)+80,80):\n    last =  i-80\n    sp = \" \"*(80-(len(str(i))+len(str(last))))\n    print(last+1,sp,i)\n    print(ref[last:i])\n    print(mid[last:i])\n    print(read[last:i])\n\n\n\nMain function\n\n\ndef Needleman_Wunsch(s1,s2,match,gap,mismatch):\n  ### Scoring:\n  pathmat = scoring(s1,s2,match,gap,mismatch)\n  ### Traceback :\n  ref, read = traceback(s1,s2,pathmat)\n  ### Print:\n  PrintAlignment(ref, read)\n\nWe can now test the function using two slightly different DNA sequences:\n\nseq1 = 'atcgccggcaacactcaaaaaaatttagatcgatgggagagagttcgatacaggggggatcgcccatcgag'\nseq2 = 'atcgctttcggcaacagtcaaaaaaatagatcgatgggggacccgagttcgatacagatcgcccatgcgt'\n\nBefore the program runs we specify scores as follows:\n\nmatch = 2        # +1 for matching\nmismatch = -1    # -1 for mismatch\ngap = -2         # -2 for gap\n\nNeedleman_Wunsch(seq1,seq2,match,gap,mismatch)\n\n1                                                                               80\natcgc---cggcaacactcaaaaaaatttagatcgatgggaga---gagttcgatacaggggggatcgcccat-cgag\n|||||   |||||||| |||||||||  |||||||||||| ||   ||||||||||||     |||||||||| ||  \natcgctttcggcaacagtcaaaaaaa--tagatcgatgggggacccgagttcgataca-----gatcgcccatgcg-t\n\n\nLets see what happens if we penalize the gaps harder:\n\n\n\n+1 for matching\n-1 for mismatch\n-2 for gap\n\n\nmatch = 2        # +1 for matching\nmismatch = -1    # -1 for mismatch\ngap = -5         # -2 for gap\n\nNeedleman_Wunsch(seq1,seq2,match,gap,mismatch)\n\n1                                                                               80\natcgc---cggcaacactcaaaaaaatttagatcgatgggagagagttcgatacaggggggatcgcccatcgag\n|||||   |||||||| |||||||||  |||||||||||| | ||      | |      ||||||||||    \natcgctttcggcaacagtcaaaaaaa--tagatcgatggg-g-gacccgagttcgatacagatcgcccatgcgt\n\n\nWe get a new alignment, as one would expect and the second gap got removed istead we have a larger space with mismatches.\n\n\n\n+1 for matching\n-1 for mismatch\n-5 for gap\n\nThese sequences were very short, this would probably even work using an recursive version of NW.\n\n\nIntron Exon\nSo to test this using a real world example we can use a DNA and the corresponding RNA and align those together.\nThe DNA sequence encodes the Lotus japonicus nin gene for nodule inception protein. It has the gene bank ID GenBank: AJ238956.1 and is about 3,4 kbp long.\nThe RNA sequence comes from the corresponding Lotus corniculatus var. japonicus mRNA for nodule inception protein (nin) GenBank: AJ239041.1 and is abput 2,9 kbp long.\nI have both sequence downloaded to my local machine and read them using the read_text function.\n\nfrom pathlib import Path\nf = Path('AJ238956_1.fasta').read_text().splitlines()\nDNA = ''.join(f[1:])\nf = Path('AJ239041_1.fasta').read_text().splitlines()\nmRNA = ''.join(f[1:])\n\n\nmatch = 2        # +1 for matching\nmismatch = -1    # -1 for mismatch\ngap = -2        # -2 for gap\n\nNeedleman_Wunsch(DNA,mRNA,match,gap,mismatch)\n\n1                                                                               80\nCCCAAGCACTGCTTATTAATTACAAACCACCTTCTCATCTCTTGCTCTTCAACTTAGCACTAGACAGAATCTAGCTTCAA\n|||||||||||||||||||||||||||||||||||||        || |   | |     |     |   ||  |||| |\nCCCAAGCACTGCTTATTAATTACAAACCACCTTCTCA--------TC-T---C-T-----T-----G---CT--CTTC-A\n81                                                                             160\nACCTAATTAAGGTGAGTGAGTCTTGTACTTGATCCACTCTTGATATTCATGCCCTCACTTTCTTTCTCACTTACTATGTG\n| |         |   | || |    ||    |  |      | |  || |     |           |  | |      \nA-C---------T---T-AG-C----AC----T--A------A-A--CA-G-----A-----------A--T-C------\n161                                                                            240\nTTTGTGGATATGTCTGAATTAATGATGATTCAACTCACTTAACTGATCATGTCAAATTACAGGTACTTAATTGGATCAGC\n        || | |               |    |||   |||    |   |  ||||| ||||||||||||||||||||\n--------TA-G-C---------------T----TCA---AAC----C---T--AATTA-AGGTACTTAATTGGATCAGC\n241                                                                            320\nTAGCATGGAATATGGTTCATTACTAGTGCAGCAGCAGCAGCAGCAGGATTGTAATTCTGCCTATGGGAGCTTGTCTAATT\n||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||\nTAGCATGGAATATGGTTCATTACTAGTGCAGCAGCAGCAGCAGCAGGATTGTAATTCTGCCTATGGGAGCTTGTCTAATT\n321                                                                            400\nTATCATCAGACTGTGGATCAGTGACAACAGCAGAAGCAGATCATCACATCATTGAGGAGCTGTTAGTACAAGGTTGCTGG\n||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||\nTATCATCAGACTGTGGATCAGTGACAACAGCAGAAGCAGATCATCACATCATTGAGGAGCTGTTAGTACAAGGTTGCTGG\n401                                                                            480\nGTGGAAGTTAGTGGTGTTGGTGTTAGGGAGGGTGAGCTCCAGCTCCAACAAGACGAATCAAGTTTTGTGGTGGGGAAGAG\n||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||\nGTGGAAGTTAGTGGTGTTGGTGTTAGGGAGGGTGAGCTCCAGCTCCAACAAGACGAATCAAGTTTTGTGGTGGGGAAGAG\n481                                                                            560\nATGGTGGATTGGACCAGCTGCAGCAGTAGCAGGATCATGTAATTCCTCTGTCAAAGAGAGACTAGTGATTGCTGTTGGGT\n||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||\nATGGTGGATTGGACCAGCTGCAGCAGTAGCAGGATCATGTAATTCCTCTGTCAAAGAGAGACTAGTGATTGCTGTTGGGT\n561                                                                            640\nACTTGAAAGACTACACAAGAAACTCCAACGTGCTCATTCAGATATGGGTGCCCTTACGAAGAGGCATCCTTCATGATCAT\n||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||\nACTTGAAAGACTACACAAGAAACTCCAACGTGCTCATTCAGATATGGGTGCCCTTACGAAGAGGCATCCTTCATGATCAT\n641                                                                            720\nGATTACCACACAAATTATTTACTTTCCAATAATCCTCCTCCTCAACCAGAAGCAGCAGCAGATCATGAATCTGTTTCACT\n||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||\nGATTACCACACAAATTATTTACTTTCCAATAATCCTCCTCCTCAACCAGAAGCAGCAGCAGATCATGAATCTGTTTCACT\n721                                                                            800\nTGGTTTTCCCATGCCAGCAGCTCCCAACTCAAACTTATACTCAAACGTGCACGTCCGTTTTTTTAGAAGCCACGAGTACC\n||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||\nTGGTTTTCCCATGCCAGCAGCTCCCAACTCAAACTTATACTCAAACGTGCACGTCCGTTTTTTTAGAAGCCACGAGTACC\n801                                                                            880\nCGCGCGTTCAGGCTCAGCAGTATGGATCTTTAGCCCTTCCTGTCTTCGAAAGAGGCACCGGGACATGCCTTGGTGTCCTT\n||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||\nCGCGCGTTCAGGCTCAGCAGTATGGATCTTTAGCCCTTCCTGTCTTCGAAAGAGGCACCGGGACATGCCTTGGTGTCCTT\n881                                                                            960\nGAGATTGTAATCACCAACCAAACCACCATCAACTACAATGTCTCCAATGCTCTTGATCAGGTACCTAGCTACTTTACTTG\n|||||||                     | || | | |     ||||  | |   |  |   | |   | ||    |   \nGAGATTG---------------------T-AA-T-C-A-----CCAA--C-C---A--A---A-C---C-AC----C---\n961                                                                           1040\nATTACTTTTCTTCTATCTACTCCCAATATTTCAGTAAAATGTGGTACTGATTATCACTTCAATAACCGCTCACACTTACA\n   |       || |   |    |  ||   |     ||  | || |      |  |  ||||    |      | |   \n---A-------TC-A---A----C--TA---C-----AA--T-GT-C------T--C--CAAT----G------C-T---\n1041                                                                          1120\nAGCCTTTTGTATCCAATTAATGTTTTGCAGGCTGTTGATTTTAGAAGCAGCCAGAGCTTCATTCCACCTGCCATCAAGGT\n   |  |||          |     | |||||||||||||||||||||||||||||||||| |     |  |  |     \n---C--TTG----------A-----T-CAGGCTGTTGATTTTAGAAGCAGCCAGAGCTTCA-T-----T--C--C-----\n1121                                                                          1200\nAGTGTGCCCTAATTATTTGTAAGGATGGATGTTCTTCATTATTTAAAGTTTAAGAAACAATAATTAATTAATAAATATTT\n|      ||                    ||  |  |         |   |      |                      \nA------CC--------------------TG--C--C---------A---T------C----------------------\n1201                                                                          1280\nATGATTAATGATGATTAGGTATATGACGAGTTGTACCAAGCAGCAGTGAATGAGATCATAGAGGTGATGACTTCTGTTTG\n             |  ||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||\n-------------A--AGGTATATGACGAGTTGTACCAAGCAGCAGTGAATGAGATCATAGAGGTGATGACTTCTGTTTG\n1281                                                                          1360\nCAAGACACACAATTTGCCATTAGCACTCACTTGGGCTCCTTGCATCCAACAAGGCAAGTGTGGTTGTGGGGTTTCATCTG\n||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||\nCAAGACACACAATTTGCCATTAGCACTCACTTGGGCTCCTTGCATCCAACAAGGCAAGTGTGGTTGTGGGGTTTCATCTG\n1361                                                                          1440\nAGAATTACATGTGGTGCGTCTCCACCGTGGATTCTGCGTGCTTTGTTGGGGATCTAGACATATTGGGATTCCAAGAAGCG\n||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||\nAGAATTACATGTGGTGCGTCTCCACCGTGGATTCTGCGTGCTTTGTTGGGGATCTAGACATATTGGGATTCCAAGAAGCG\n1441                                                                          1520\nTGCTCTGAGTATCACCTTTTCCGGGGACAAGGAATTGTTGGTACAGCCTTCACAACATCCAAACCGTGTTTCGCCATTGA\n||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||\nTGCTCTGAGTATCACCTTTTCCGGGGACAAGGAATTGTTGGTACAGCCTTCACAACATCCAAACCGTGTTTCGCCATTGA\n1521                                                                          1600\nCATCACAGCCTTCAGCAAAGCTGAATACCCTCTTGCTCACCATGCAAACATGTTCGGATTGCATGCAGCTGTGGCCATTC\n||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||\nCATCACAGCCTTCAGCAAAGCTGAATACCCTCTTGCTCACCATGCAAACATGTTCGGATTGCATGCAGCTGTGGCCATTC\n1601                                                                          1680\nCACTCAGGAGTGTCTACACCGGTTCAGCTGCTGATTTTGTTTTGGAGTTTTTCCTTCCAAAAGATTGCCATGACAGTGAA\n||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||\nCACTCAGGAGTGTCTACACCGGTTCAGCTGCTGATTTTGTTTTGGAGTTTTTCCTTCCAAAAGATTGCCATGACAGTGAA\n1681                                                                          1760\nGAGCAGAAGCAGTTGCTCAACTCATTGTCCATGGTGGTACAGCAAGCTTGCCGCAGCTTGCATGTGGTACTGGTGGAGGA\n||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||\nGAGCAGAAGCAGTTGCTCAACTCATTGTCCATGGTGGTACAGCAAGCTTGCCGCAGCTTGCATGTGGTACTGGTGGAGGA\n1761                                                                          1840\nTGAATACACCTTGCCGATGCCATCACACACTAGTAAAGAGGAATTAGAAGAAGAAGAGATTACCATTACCAATAATCATG\n||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||\nTGAATACACCTTGCCGATGCCATCACACACTAGTAAAGAGGAATTAGAAGAAGAAGAGATTACCATTACCAATAATCATG\n1841                                                                          1920\nAGCAGAAATTATTTGTGTCTCCCTCCTCTCATGAATCAGAATGTTCAAAAGAATCATCATGGATTGCACACATGATGGAG\n||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||\nAGCAGAAATTATTTGTGTCTCCCTCCTCTCATGAATCAGAATGTTCAAAAGAATCATCATGGATTGCACACATGATGGAG\n1921                                                                          2000\nGCTCAGCAGAAGGGGAAAGGTGTGTCTGTGTCTTTGGAGTACTTGGAAGAACCAAAGGAGGAGTTCAAAGTAACAACAAA\n||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||\nGCTCAGCAGAAGGGGAAAGGTGTGTCTGTGTCTTTGGAGTACTTGGAAGAACCAAAGGAGGAGTTCAAAGTAACAACAAA\n2001                                                                          2080\nCTGGGACAGCAGCACTGACCATGATCAGCAGGCGCAGGTGTTTTCATCAGATTTTGGGCAAATGAGTTCAGGATTCAAAG\n||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||\nCTGGGACAGCAGCACTGACCATGATCAGCAGGCGCAGGTGTTTTCATCAGATTTTGGGCAAATGAGTTCAGGATTCAAAG\n2081                                                                          2160\nCAAGTACTGTGGAGGGTGGGGATCAAGAGTCTTCTTATACCTTTGGAAGCCGCCGCTCGTCTTCTGGTGGAAGAAAGTCA\n||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||\nCAAGTACTGTGGAGGGTGGGGATCAAGAGTCTTCTTATACCTTTGGAAGCCGCCGCTCGTCTTCTGGTGGAAGAAAGTCA\n2161                                                                          2240\nGGCGAGAAGAGACGAACCAAGGCAGAGAAGACTATCAGCTTGCAAGTTCTAAGACAGTACTTTGCAGGAAGCCTAAAAGA\n|||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||    ||       ||\nGGCGAGAAGAGACGAACCAAGGCAGAGAAGACTATCAGCTTGCAAGTTCTAAGACAGTACTTTGC----AG-------GA\n2241                                                                          2320\nTGCAGCAAAGAGCATTGGTGGTGAGTGACATATCTTCTTGAATTCAACTCAACCATTCAATTAATTATTAAATGATAACA\n   |||      |        | |   | | |       |                               |||    | \n---AGC------C--------T-A---A-A-A-------G-------------------------------ATG----C-\n2321                                                                          2400\nAAGTTAATTTAGTGGGTGACTTAATTAAGAAAGTGATCCTTGTATGGTTGTACAGTTAAATGATGGTGTTTCCTTTTGAT\n          |      | |          ||   |     | |     |  |         ||  ||         |  \n----------A------G-C----------AA---A-----G-A-----G--C---------AT--TG---------G--\n2401                                                                          2480\nTTCTACAGTATGTCCCACAACTCTGAAAAGGATATGCAGACAGCATGGCATCACCAGGTGGCCTTCAAGGAAAATCAAGA\n   |   |||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||\n---T---GTATGTCCCACAACTCTGAAAAGGATATGCAGACAGCATGGCATCACCAGGTGGCCTTCAAGGAAAATCAAGA\n2481                                                                          2560\nAGGTTGGCCATTCTTTAAAAAAGCTTCAGCTGGTGATTGATTCAGTGCAGGGTGCTGAGGGTGCCATACAGATTGGCTCA\n||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||\nAGGTTGGCCATTCTTTAAAAAAGCTTCAGCTGGTGATTGATTCAGTGCAGGGTGCTGAGGGTGCCATACAGATTGGCTCA\n2561                                                                          2640\nTTCTATGCCAGTTTTCCAGAGTTGAGCTCTTCAGATTTCTCTGCCAGTTGCCGTTCTGATTCATCCAAGAAAATGCATAA\n||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||\nTTCTATGCCAGTTTTCCAGAGTTGAGCTCTTCAGATTTCTCTGCCAGTTGCCGTTCTGATTCATCCAAGAAAATGCATAA\n2641                                                                          2720\nTTATCCTGATCAGAACAACACCTTGTATGGCCATGGAGATCATGGAGGAGTTGTTACTAGTTTAAAATCTCCACCCTCTG\n||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||\nTTATCCTGATCAGAACAACACCTTGTATGGCCATGGAGATCATGGAGGAGTTGTTACTAGTTTAAAATCTCCACCCTCTG\n2721                                                                          2800\nCTTGCAGCCAAACTTTTGCAGGAAACCAACCATGCACCATCATCAACAATGGAGATGTTCTTATGACAGAAAGTCCTCCA\n||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||\nCTTGCAGCCAAACTTTTGCAGGAAACCAACCATGCACCATCATCAACAATGGAGATGTTCTTATGACAGAAAGTCCTCCA\n2801                                                                          2880\nGTCCCTGAAGCATTGCTGAGTAGGAGAGATCACTGTGAGGAAGCAGAATTATTGAACAATGCATCTATCCAAGAGGATAC\n||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||\nGTCCCTGAAGCATTGCTGAGTAGGAGAGATCACTGTGAGGAAGCAGAATTATTGAACAATGCATCTATCCAAGAGGATAC\n2881                                                                          2960\nAAAGCGTTTCAGCAGACCCAAGAGCCAAACCCTACCTCCCTTGTCTGACAGCAGTGGCTGGAACTCACTGGAAACAGGTG\n||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||\nAAAGCGTTTCAGCAGACCCAAGAGCCAAACCCTACCTCCCTTGTCTGACAGCAGTGGCTGGAACTCACTGGAAACAGGTG\n2961                                                                          3040\nCTTTCAGAGTGAAAGCAACTTTTGCAGATGAGAAGATCCGCTTCAGCTTGCAACCCATTTGGGGGTTCAGTGATTTGCAG\n||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||\nCTTTCAGAGTGAAAGCAACTTTTGCAGATGAGAAGATCCGCTTCAGCTTGCAACCCATTTGGGGGTTCAGTGATTTGCAG\n3041                                                                          3120\nCTAGAGATAGCAAGACGGTTCAATCTAAATGATGTGACCAACATCCTTCTCAAGTATCTGGATGATGATGGAGAGTGGGT\n||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||\nCTAGAGATAGCAAGACGGTTCAATCTAAATGATGTGACCAACATCCTTCTCAAGTATCTGGATGATGATGGAGAGTGGGT\n3121                                                                          3200\nAGTTTTAGCATGTGATGGTGATCTTGAGGAGTGCAAAGACATACACAGATCATCTCAGAGCCGGACAATTAGACTCTCCC\n||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||\nAGTTTTAGCATGTGATGGTGATCTTGAGGAGTGCAAAGACATACACAGATCATCTCAGAGCCGGACAATTAGACTCTCCC\n3201                                                                          3280\nTTTTTCAAGCTTCGCCTCTAAATCTAGCTAATACATTCCGCAATAGCAGCCCATCTTAACATAACACCAATTCTCTGCTT\n||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||\nTTTTTCAAGCTTCGCCTCTAAATCTAGCTAATACATTCCGCAATAGCAGCCCATCTTAACATAACACCAATTCTCTGCTT\n3281                                                                          3360\nTTCTTGAGCTTTAAGCCTCAAGAGAGAGGTGTGTTTGTTTGTGTATACTGTGTAGGATCCCAATCCCAATCCCATCCCAA\n||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||\nTTCTTGAGCTTTAAGCCTCAAGAGAGAGGTGTGTTTGTTTGTGTATACTGTGTAGGATCCCAATCCCAATCCCATCCCAA\n3361                                                                          3440\nGCAAACATATACATTTAATTACTGGTTTTACTTGTTTG-----------------A\n||||||||||||||||||||||||||||||||||||||                 |\nGCAAACATATACATTTAATTACTGGTTTTACTTGTTTGAAAAAAAAAAAAAAAAAA\n\n\n\n\nHomolog proteins\nNext I download two homolog protein sequences by sending http requests to the uniprot database and tried to align those to each other.\n\nf = Path('P51587.fasta').read_text().splitlines()\nP51587 = ''.join(f[1:])\nf = Path('G3SGJ0.fasta').read_text().splitlines()\nG3SGJ0 = ''.join(f[1:])\n\n\nimport urllib3\nlink1 = \"https://rest.uniprot.org/uniprotkb/P51587.fasta\"\nlink2 = \"https://rest.uniprot.org/uniprotkb/G3SGJ0.fasta\"\nhttp = urllib3.PoolManager()\n\nf = http.request(\"GET\",link1)\n\nP51587 = ''.join(str(http.request(\"GET\",link1).data).split('\\\\n')[1:-1])\nG3SGJ0 = ''.join(str(http.request(\"GET\",link2).data).split('\\\\n')[1:-1])\n\nBut before we run the alignment of the proteins, we should change the current Needleman Wunsch implementation to use a substitution matrix instead of a generic scoring scheme. Below is the BLUSUM62 substituion matrix:\n\n\nCode\nblosum62 = {\n    ('W', 'F'): 1, ('L', 'R'): -2, ('S', 'P'): -1, ('V', 'T'): 0,\n    ('Q', 'Q'): 5, ('N', 'A'): -2, ('Z', 'Y'): -2, ('W', 'R'): -3,\n    ('Q', 'A'): -1, ('S', 'D'): 0, ('H', 'H'): 8, ('S', 'H'): -1,\n    ('H', 'D'): -1, ('L', 'N'): -3, ('W', 'A'): -3, ('Y', 'M'): -1,\n    ('G', 'R'): -2, ('Y', 'I'): -1, ('Y', 'E'): -2, ('B', 'Y'): -3,\n    ('Y', 'A'): -2, ('V', 'D'): -3, ('B', 'S'): 0, ('Y', 'Y'): 7,\n    ('G', 'N'): 0, ('E', 'C'): -4, ('Y', 'Q'): -1, ('Z', 'Z'): 4,\n    ('V', 'A'): 0, ('C', 'C'): 9, ('M', 'R'): -1, ('V', 'E'): -2,\n    ('T', 'N'): 0, ('P', 'P'): 7, ('V', 'I'): 3, ('V', 'S'): -2,\n    ('Z', 'P'): -1, ('V', 'M'): 1, ('T', 'F'): -2, ('V', 'Q'): -2,\n    ('K', 'K'): 5, ('P', 'D'): -1, ('I', 'H'): -3, ('I', 'D'): -3,\n    ('T', 'R'): -1, ('P', 'L'): -3, ('K', 'G'): -2, ('M', 'N'): -2,\n    ('P', 'H'): -2, ('F', 'Q'): -3, ('Z', 'G'): -2, ('X', 'L'): -1,\n    ('T', 'M'): -1, ('Z', 'C'): -3, ('X', 'H'): -1, ('D', 'R'): -2,\n    ('B', 'W'): -4, ('X', 'D'): -1, ('Z', 'K'): 1, ('F', 'A'): -2,\n    ('Z', 'W'): -3, ('F', 'E'): -3, ('D', 'N'): 1, ('B', 'K'): 0,\n    ('X', 'X'): -1, ('F', 'I'): 0, ('B', 'G'): -1, ('X', 'T'): 0,\n    ('F', 'M'): 0, ('B', 'C'): -3, ('Z', 'I'): -3, ('Z', 'V'): -2,\n    ('S', 'S'): 4, ('L', 'Q'): -2, ('W', 'E'): -3, ('Q', 'R'): 1,\n    ('N', 'N'): 6, ('W', 'M'): -1, ('Q', 'C'): -3, ('W', 'I'): -3,\n    ('S', 'C'): -1, ('L', 'A'): -1, ('S', 'G'): 0, ('L', 'E'): -3,\n    ('W', 'Q'): -2, ('H', 'G'): -2, ('S', 'K'): 0, ('Q', 'N'): 0,\n    ('N', 'R'): 0, ('H', 'C'): -3, ('Y', 'N'): -2, ('G', 'Q'): -2,\n    ('Y', 'F'): 3, ('C', 'A'): 0, ('V', 'L'): 1, ('G', 'E'): -2,\n    ('G', 'A'): 0, ('K', 'R'): 2, ('E', 'D'): 2, ('Y', 'R'): -2,\n    ('M', 'Q'): 0, ('T', 'I'): -1, ('C', 'D'): -3, ('V', 'F'): -1,\n    ('T', 'A'): 0, ('T', 'P'): -1, ('B', 'P'): -2, ('T', 'E'): -1,\n    ('V', 'N'): -3, ('P', 'G'): -2, ('M', 'A'): -1, ('K', 'H'): -1,\n    ('V', 'R'): -3, ('P', 'C'): -3, ('M', 'E'): -2, ('K', 'L'): -2,\n    ('V', 'V'): 4, ('M', 'I'): 1, ('T', 'Q'): -1, ('I', 'G'): -4,\n    ('P', 'K'): -1, ('M', 'M'): 5, ('K', 'D'): -1, ('I', 'C'): -1,\n    ('Z', 'D'): 1, ('F', 'R'): -3, ('X', 'K'): -1, ('Q', 'D'): 0,\n    ('X', 'G'): -1, ('Z', 'L'): -3, ('X', 'C'): -2, ('Z', 'H'): 0,\n    ('B', 'L'): -4, ('B', 'H'): 0, ('F', 'F'): 6, ('X', 'W'): -2,\n    ('B', 'D'): 4, ('D', 'A'): -2, ('S', 'L'): -2, ('X', 'S'): 0,\n    ('F', 'N'): -3, ('S', 'R'): -1, ('W', 'D'): -4, ('V', 'Y'): -1,\n    ('W', 'L'): -2, ('H', 'R'): 0, ('W', 'H'): -2, ('H', 'N'): 1,\n    ('W', 'T'): -2, ('T', 'T'): 5, ('S', 'F'): -2, ('W', 'P'): -4,\n    ('L', 'D'): -4, ('B', 'I'): -3, ('L', 'H'): -3, ('S', 'N'): 1,\n    ('B', 'T'): -1, ('L', 'L'): 4, ('Y', 'K'): -2, ('E', 'Q'): 2,\n    ('Y', 'G'): -3, ('Z', 'S'): 0, ('Y', 'C'): -2, ('G', 'D'): -1,\n    ('B', 'V'): -3, ('E', 'A'): -1, ('Y', 'W'): 2, ('E', 'E'): 5,\n    ('Y', 'S'): -2, ('C', 'N'): -3, ('V', 'C'): -1, ('T', 'H'): -2,\n    ('P', 'R'): -2, ('V', 'G'): -3, ('T', 'L'): -1, ('V', 'K'): -2,\n    ('K', 'Q'): 1, ('R', 'A'): -1, ('I', 'R'): -3, ('T', 'D'): -1,\n    ('P', 'F'): -4, ('I', 'N'): -3, ('K', 'I'): -3, ('M', 'D'): -3,\n    ('V', 'W'): -3, ('W', 'W'): 11, ('M', 'H'): -2, ('P', 'N'): -2,\n    ('K', 'A'): -1, ('M', 'L'): 2, ('K', 'E'): 1, ('Z', 'E'): 4,\n    ('X', 'N'): -1, ('Z', 'A'): -1, ('Z', 'M'): -1, ('X', 'F'): -1,\n    ('K', 'C'): -3, ('B', 'Q'): 0, ('X', 'B'): -1, ('B', 'M'): -3,\n    ('F', 'C'): -2, ('Z', 'Q'): 3, ('X', 'Z'): -1, ('F', 'G'): -3,\n    ('B', 'E'): 1, ('X', 'V'): -1, ('F', 'K'): -3, ('B', 'A'): -2,\n    ('X', 'R'): -1, ('D', 'D'): 6, ('W', 'G'): -2, ('Z', 'F'): -3,\n    ('S', 'Q'): 0, ('W', 'C'): -2, ('W', 'K'): -3, ('H', 'Q'): 0,\n    ('L', 'C'): -1, ('W', 'N'): -4, ('S', 'A'): 1, ('L', 'G'): -4,\n    ('W', 'S'): -3, ('S', 'E'): 0, ('H', 'E'): 0, ('S', 'I'): -2,\n    ('H', 'A'): -2, ('S', 'M'): -1, ('Y', 'L'): -1, ('Y', 'H'): 2,\n    ('Y', 'D'): -3, ('E', 'R'): 0, ('X', 'P'): -2, ('G', 'G'): 6,\n    ('G', 'C'): -3, ('E', 'N'): 0, ('Y', 'T'): -2, ('Y', 'P'): -3,\n    ('T', 'K'): -1, ('A', 'A'): 4, ('P', 'Q'): -1, ('T', 'C'): -1,\n    ('V', 'H'): -3, ('T', 'G'): -2, ('I', 'Q'): -3, ('Z', 'T'): -1,\n    ('C', 'R'): -3, ('V', 'P'): -2, ('P', 'E'): -1, ('M', 'C'): -1,\n    ('K', 'N'): 0, ('I', 'I'): 4, ('P', 'A'): -1, ('M', 'G'): -3,\n    ('T', 'S'): 1, ('I', 'E'): -3, ('P', 'M'): -2, ('M', 'K'): -1,\n    ('I', 'A'): -1, ('P', 'I'): -3, ('R', 'R'): 5, ('X', 'M'): -1,\n    ('L', 'I'): 2, ('X', 'I'): -1, ('Z', 'B'): 1, ('X', 'E'): -1,\n    ('Z', 'N'): 0, ('X', 'A'): 0, ('B', 'R'): -1, ('B', 'N'): 3,\n    ('F', 'D'): -3, ('X', 'Y'): -1, ('Z', 'R'): 0, ('F', 'H'): -1,\n    ('B', 'F'): -3, ('F', 'L'): 0, ('X', 'Q'): -1, ('B', 'B'): 4\n}\n\n\n\ndef scoring_submat(s1,s2,gap,submatrix):\n  l1 = len(s1)+1\n  l2 = len(s2)+1\n  mat = np.zeros((l1,l2),dtype= int) # score matrix\n  pathmat = np.zeros((l1,l2),dtype= int) # path matrix\n  mat[:,0]=[ i *gap for i in range(l1)]# fill first col \n  mat[0,:]=[ j *gap for j in range(l2)]# fill first row\n  for i in range(1,l1):\n    for j in range(1,l2):\n      n=[]\n      #### get substitution score \n      try:\n        subval = submatrix[(s1[i-1],s2[j-1])]\n      except KeyError:\n        try:\n          subval = submatrix[(s2[j-1],s1[i-1])]\n        except KeyError:\n          print(\"ERROR: 'AA not in substitution matrix'\")\n          return\n      #### end submatrix check \n      n.append(mat[i-1,j-1] + subval) # match \n      n.append(mat[i,j-1] + gap)  #top insertion\n      n.append(mat[i-1,j] + gap)  #left deletion\n      \n      mat[i,j]=max(n) # keep maximal score \n      pathmat[i,j] = np.argmax(n)\n  return(pathmat)\n\n\ndef Needleman_Wunsch_submat(s1,s2,gap,submatrix):\n  ### Scoring:\n  pathmat = scoring_submat(s1,s2,gap,submatrix)\n  ### Traceback :\n  ref, read = traceback(s1,s2,pathmat)\n  ### Print:\n  PrintAlignment(ref, read)\n\nNW alignment of P51587 with G3SGJ0 using the blosum64 submatrix\n\nNeedleman_Wunsch_submat(P51587,G3SGJ0,gap,blosum62)\n\n1                                                                               80\nMPIGSKERPTFFEIFKTRCNKADLGPISLNWFEELSSEAPPYNSEPAEESEHKNNNYEPNLFKTPQRKPSYNQLASTPII\n||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||\nMPIGSKERPTFFEIFKTRCNKADLGPISLNWFEELSSEAPPYNSEPAEESEHKNNNYEPNLFKTPQRKPSYNQLASTPII\n81                                                                             160\nFKEQGLTLPLYQSPVKELDKFKLDLGRNVPNSRHKSLRTVKTKMDQADDVSCPLLNSCLSESPVVLQCTHVTPQRDKSVV\n||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||\nFKEQGLTLPLYQSPVKELDKFKLDLGRNVPNSRHKSLRTVKTKMDQADDVSCPLLNSCLSESPVVLQCTHVTPQRDKSVV\n161                                                                            240\nCGSLFHTPKFVKGRQTPKHISESLGAEVDPDMSWSSSLATPPTLSSTVLIVRNEEASETVFPHDTTANVKSYFSNHDESL\n||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||\nCGSLFHTPKFVKGRQTPKHISESLGAEVDPDMSWSSSLATPPTLSSTVLIVRNEEASETVFPHDTTANVKSYFSNHDESL\n241                                                                            320\nKKNDRFIASVTDSENTNQREAASHGFGKTSGNSFKVNSCKDHIGKSMPNVLEDEVYETVVDTSEEDSFSLCFSKCRTKNL\n||||||||||||||||||||| ||||||||||||||||||||||||||||||||||||||||||||||||||||||||||\nKKNDRFIASVTDSENTNQREATSHGFGKTSGNSFKVNSCKDHIGKSMPNVLEDEVYETVVDTSEEDSFSLCFSKCRTKNL\n321                                                                            400\nQKVRTSKTRKKIFHEANADECEKSKNQVKEKYSFVSEVEPNDTDPLDSNVANQKPFESGSDKISKEVVPSLACEWSQLTL\n|||||||||||| |||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||\nQKVRTSKTRKKISHEANADECEKSKNQVKEKYSFVSEVEPNDTDPLDSNVANQKPFESGSDKISKEVVPSLACEWSQLTL\n401                                                                            480\nSGLNGAQMEKIPLLHISSCDQNISEKDLLDTENKRKKDFLTSENSLPRISSLPKSEKPLNEETVVNKRDEEQHLESHTDC\n|||||||||||||| |||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||\nSGLNGAQMEKIPLLNISSCDQNISEKDLLDTENKRKKDFLTSENSLPRISSLPKSEKPLNEETVVNKRDEEQHLESHTDC\n481                                                                            560\nILAVKQAISGTSPVASSFQGIKKSIFRIRESPKETFNASFSGHMTDPNFKKETEASESGLEIHTVCSQKEDSLCPNLIDN\n|||||||||||||||||||||||||||||||||||| |||||||||||||||||||||||||||||||||||||||||||\nILAVKQAISGTSPVASSFQGIKKSIFRIRESPKETFGASFSGHMTDPNFKKETEASESGLEIHTVCSQKEDSLCPNLIDN\n561                                                                            640\nGSWPATTTQNSVALKNAGLISTLKKKTNKFIYAIHDETSYKGKKIPKDQKSELINCSAQFEANAFEAPLTFANADSGLLH\n||||||||| ||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||\nGSWPATTTQTSVALKNAGLISTLKKKTNKFIYAIHDETSYKGKKIPKDQKSELINCSAQFEANAFEAPLTFANADSGLLH\n641                                                                            720\nSSVKRSCSQNDSEEPTLSLTSSFGTILRKCSRNETCSNNTVISQDLDYKEAKCNKEKLQLFITPEADSLSCLQEGQCEND\n|||||||||||||||||||||||||||||||||||||| |||||||||||||||||||||||||||||||||||||||||\nSSVKRSCSQNDSEEPTLSLTSSFGTILRKCSRNETCSNDTVISQDLDYKEAKCNKEKLQLFITPEADSLSCLQEGQCEND\n721                                                                            800\nPKSKKVSDIKEEVLAAACHPVQHSKVEYSDTDFQSQKSLLYDHENASTLILTPTSKDVLSNLVMISRGKESYKMSDKLKG\n||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||\nPKSKKVSDIKEEVLAAACHPVQHSKVEYSDTDFQSQKSLLYDHENASTLILTPTSKDVLSNLVMISRGKESYKMSDKLKG\n801                                                                            880\nNNYESDVELTKNIPMEKNQDVCALNENYKNVELLPPEKYMRVASPSRKVQFNQNTNLRVIQKNQEETTSISKITVNPDSE\n||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||\nNNYESDVELTKNIPMEKNQDVCALNENYKNVELLPPEKYMRVASPSRKVQFNQNTNLRVIQKNQEETTSISKITVNPDSE\n881                                                                            960\nELFSDNENNFVFQVANERNNLALGNTKELHETDLTCVNEPIFKNSTMVLYGDTGDKQATQVSIKKDLVYVLAEENKNSVK\n|||||||||||||||||||||||||||||||||||||||||||| |||||||||||||||||||||||||||||||||||\nELFSDNENNFVFQVANERNNLALGNTKELHETDLTCVNEPIFKNPTMVLYGDTGDKQATQVSIKKDLVYVLAEENKNSVK\n961                                                                           1040\nQHIKMTLGQDLKSDISLNIDKIPEKNNDYMNKWAGLLGPISNHSFGGSFRTASNKEIKLSEHNIKKSKMFFKDIEEQYPT\n||||||||||||||||||||||| |||||| |||||||||||||||||||||||||||||||||||||||||||||||||\nQHIKMTLGQDLKSDISLNIDKIPDKNNDYMDKWAGLLGPISNHSFGGSFRTASNKEIKLSEHNIKKSKMFFKDIEEQYPT\n1041                                                                          1120\nSLACVEIVNTLALDNQKKLSKPQSINTVSAHLQSSVVVSDCKNSHITPQMLFSKQDFNSNHNLTPSQKAEITELSTILEE\n||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||\nSLACVEIVNTLALDNQKKLSKPQSINTVSAHLQSSVVVSDCKNSHITPQMLFSKQDFNSNHNLTPSQKAEITELSTILEE\n1121                                                                          1200\nSGSQFEFTQFRKPSYILQKSTFEVPENQMTILKTTSEECRDADLHVIMNAPSIGQVDSSKQFEGTVEIKRKFAGLLKNDC\n||||||||||||||||||||||||||||||||||||||||||||||||||||||| ||||||||||||||||||||||||\nSGSQFEFTQFRKPSYILQKSTFEVPENQMTILKTTSEECRDADLHVIMNAPSIGQLDSSKQFEGTVEIKRKFAGLLKNDC\n1201                                                                          1280\nNKSASGYLTDENEVGFRGFYSAHGTKLNVSTEALQKAVKLFSDIENISEETSAEVHPISLSSSKCHDSVVSMFKIENHND\n|||||||||||||||||||||||| |||||||||||||||||||||||||||||||||||||||||||||||||||||||\nNKSASGYLTDENEVGFRGFYSAHGAKLNVSTEALQKAVKLFSDIENISEETSAEVHPISLSSSKCHDSVVSMFKIENHND\n1281                                                                          1360\nKTVSEKNNKCQLILQNNIEMTTGTFVEEITENYKRNTENEDNKYTAASRNSHNLEFDGSDSSKNDTVCIHKDETDLLFTD\n|||||| |||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||\nKTVSEK-NKCQLILQNNIEMTTGTFVEEITENYKRNTENEDNKYTAASRNSHNLEFDGSDSSKNDTVCIHKDETDLLFTD\n1361                                                                          1440\nQHNICLKLSGQFMKEGNTQIKEDLSDLTFLEVAKAQEACHGNTSNKEQLTATKTEQNIKDFETSDTFFQTASGKNISVAK\n|||||||||||||||||||||||||||||||| |||||||||||||||||||||||||||||||||||||||||||||||\nQHNICLKLSGQFMKEGNTQIKEDLSDLTFLEVVKAQEACHGNTSNKEQLTATKTEQNIKDFETSDTFFQTASGKNISVAK\n1441                                                                          1520\nESFNKIVNFFDQKPEELHNFSLNSELHSDIRKNKMDILSYEETDIVKHKILKESVPVGTGNQLVTFQGQPERDEKIKEPT\n||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||\nESFNKIVNFFDQKPEELHNFSLNSELHSDIRKNKMDILSYEETDIVKHKILKESVPVGTGNQLVTFQGQPERDEKIKEPT\n1521                                                                          1600\nLLGFHTASGKKVKIAKESLDKVKNLFDEKEQGTSEITSFSHQWAKTLKYREACKDLELACETIEITAAPKCKEMQNSLNN\n|||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||| |||||||||||||\nLLGFHTASGKKVKIAKESLDKVKNLFDEKEQGTSEITSFSHQWAKTLKYREACKDLELACETIEITTAPKCKEMQNSLNN\n1601                                                                          1680\nDKNLVSIETVVPPKLLSDNLCRQTENLKTSKSIFLKVKVHENVEKETAKSPATCYTNQSPYSVIENSALAFYTSCSRKTS\n||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||\nDKNLVSIETVVPPKLLSDNLCRQTENLKTSKSIFLKVKVHENVEKETAKSPATCYTNQSPYSVIENSALAFYTSCSRKTS\n1681                                                                          1760\nVSQTSLLEAKKWLREGIFDGQPERINTADYVGNYLYENNSNSTIAENDKNHLSEKQDTYLSNSSMSNSYSYHSDEVYNDS\n|||||| |||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||\nVSQTSLREAKKWLREGIFDGQPERINTADYVGNYLYENNSNSTIAENDKNHLSEKQDTYLSNSSMSNSYSYHSDEVYNDS\n1761                                                                          1840\nGYLSKNKLDSGIEPVLKNVEDQKNTSFSKVISNVKDANAYPQTVNEDICVEELVTSSSPCKNKNAAIKLSISNSNNFEVG\n||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||\nGYLSKNKLDSGIEPVLKNVEDQKNTSFSKVISNVKDANAYPQTVNEDICVEELVTSSSPCKNKNAAIKLSISNSNNFEVG\n1841                                                                          1920\nPPAFRIASGKIVCVSHETIKKVKDIFTDSFSKVIKENNENKSKICQTKIMAGCYEALDDSEDILHNSLDNDECSTHSHKV\n|||||||||||||||||||||||| |||||||||||||||||||||||||||||||||||||||||||||||||||||||\nPPAFRIASGKIVCVSHETIKKVKDMFTDSFSKVIKENNENKSKICQTKIMAGCYEALDDSEDILHNSLDNDECSTHSHKV\n1921                                                                          2000\nFADIQSEEILQHNQNMSGLEKVSKISPCDVSLETSDICKCSIGKLHKSVSSANTCGIFSTASGKSVQVSDASLQNARQVF\n||||||||||||||||||||||||||||||||||||||||||||||||||| ||||||||||||||||||||||||||||\nFADIQSEEILQHNQNMSGLEKVSKISPCDVSLETSDICKCSIGKLHKSVSSTNTCGIFSTASGKSVQVSDASLQNARQVF\n2001                                                                          2080\nSEIEDSTKQVFSKVLFKSNEHSDQLTREENTAIRTPEHLISQKGFSYNVVNSSAFSGFSTASGKQVSILESSLHKVKGVL\n||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||\nSEIEDSTKQVFSKVLFKSNEHSDQLTREENTAIRTPEHLISQKGFSYNVVNSSAFSGFSTASGKQVSILESSLHKVKGVL\n2081                                                                          2160\nEEFDLIRTEHSLHYSPTSRQNVSKILPRVDKRNPEHCVNSEMEKTCSKEFKLSNNLNVEGGSSENNHSIKVSPYLSQFQQ\n||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||\nEEFDLIRTEHSLHYSPTSRQNVSKILPRVDKRNPEHCVNSEMEKTCSKEFKLSNNLNVEGGSSENNHSIKVSPYLSQFQQ\n2161                                                                          2240\nDKQQLVLGTKVSLVENIHVLGKEQASPKNVKMEIGKTETFSDVPVKTNIEVCSTYSKDSENYFETEAVEIAKAFMEDDEL\n||||||||||||||||||||||||||| |||||||||| |||||||||||||||||||||||||||||||||||||||||\nDKQQLVLGTKVSLVENIHVLGKEQASPENVKMEIGKTEAFSDVPVKTNIEVCSTYSKDSENYFETEAVEIAKAFMEDDEL\n2241                                                                          2320\nTDSKLPSHATHSLFTCPENEEMVLSNSRIGKRRGEPLILVGEPSIKRNLLNEFDRIIENQEKSLKASKSTPDGTIKDRRL\n||| |||||||||||||||||||||||| |||||||||||||||||||||||||||||||||||||||||||||||||||\nTDSELPSHATHSLFTCPENEEMVLSNSRTGKRRGEPLILVGEPSIKRNLLNEFDRIIENQEKSLKASKSTPDGTIKDRRL\n2321                                                                          2400\nFMHHVSLEPITCVPFRTTKERQEIQNPNFTAPGQEFLSKSHLYEHLTLEKSSSNLAVSGHPFYQVSATRNEKMRHLITTG\n|||||||||||||||||||| ||||||||||||||||| |||||||||||||||||||||||||||||||||||||||||\nFMHHVSLEPITCVPFRTTKEHQEIQNPNFTAPGQEFLSESHLYEHLTLEKSSSNLAVSGHPFYQVSATRNEKMRHLITTG\n2401                                                                          2480\nRPTKVFVPPFKTKSHFHRVEQCVRNINLEENRQKQNIDGHGSDDSKNKINDNEIHQFNKNNSNQAVAVTFTKCEEEPLDL\n||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||| ||||||||||||||\nRPTKVFVPPFKTKSHFHRVEQCVRNINLEENRQKQNIDGHGSDDSKNKINDNEIHQFNKNNSNQAAAVTFTKCEEEPLDL\n2481                                                                          2560\nITSLQNARDIQDMRIKKKQRQRVFPQPGSLYLAKTSTLPRISLKAAVGGQVPSACSHKQLYTYGVSKHCIKINSKNAESF\n||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||\nITSLQNARDIQDMRIKKKQRQRVFPQPGSLYLAKTSTLPRISLKAAVGGQVPSACSHKQLYTYGVSKHCIKINSKNAESF\n2561                                                                          2640\nQFHTEDYFGKESLWTGKGIQLADGGWLIPSNDGKAGKEEFYRALCDTPGVDPKLISRIWVYNHYRWIIWKLAAMECAFPK\n|||||||||||||||||||||||||||||| |||||||||||||||||||||||||||||||||||||||||||||||||\nQFHTEDYFGKESLWTGKGIQLADGGWLIPSSDGKAGKEEFYRALCDTPGVDPKLISRIWVYNHYRWIIWKLAAMECAFPK\n2641                                                                          2720\nEFANRCLSPERVLLQLKYRYDTEIDRSRRSAIKKIMERDDTAAKTLVLCVSDIISLSANISETSSNKTSSADTQKVAIIE\n||||||||||||||||||||| ||||||||||||||||||||||||||||||||||||||||||||||||||||||||||\nEFANRCLSPERVLLQLKYRYDMEIDRSRRSAIKKIMERDDTAAKTLVLCVSDIISLSANISETSSNKTSSADTQKVAIIE\n2721                                                                          2800\nLTDGWYAVKAQLDPPLLAVLKNGRLTVGQKIILHGAELVGSPDACTPLEAPESLMLKISANSTRPARWYTKLGFFPDPRP\n||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||\nLTDGWYAVKAQLDPPLLAVLKNGRLTVGQKIILHGAELVGSPDACTPLEAPESLMLKISANSTRPARWYTKLGFFPDPRP\n2801                                                                          2880\nFPLPLSSLFSDGGNVGCVDVIIQRAYPIQWMEKTSSGLYIFRNEREEEKEAAKYVEAQQKRLEALFTKIQEEFEEHEENT\n||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||\nFPLPLSSLFSDGGNVGCVDVIIQRAYPIQWMEKTSSGLYIFRNEREEEKEAAKYVEAQQKRLEALFTKIQEEFEEHEENT\n2881                                                                          2960\nTKPYLPSRALTRQQVRALQDGAELYEAVKNAADPAYLEGYFSEEQLRALNNHRQMLNDKKQAQIQLEIRKAMESAEQKEQ\n||||||||||||||||||||||||||||||||||| ||||||||||||||||||||||||||||||| ||||||||||| \nTKPYLPSRALTRQQVRALQDGAELYEAVKNAADPANLEGYFSEEQLRALNNHRQMLNDKKQAQIQLEVRKAMESAEQKEK\n2961                                                                          3040\nGLSRDVTTVWKLRIVSYSKKEKDSVILSIWRPSSDLYSLLTEGKRYRIYHLATSKSKSKSERANIQLAATKKTQYQQLPV\n||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||\nGLSRDVTTVWKLRIVSYSKKEKDSVILSIWRPSSDLYSLLTEGKRYRIYHLATSKSKSKSERANIQLAATKKTQYQQLPV\n3041                                                                          3120\nSDEILFQIYQPREPLHFSKFLDPDFQPSCSEVDLIGFVVSVVKKTGLAPFVYLSDECYNLLAIKFWIDLNEDIIKPHMLI\n||||||| |||||||||||||||||||||||||||||| |||||||||||||||||||||||||||||||||||||||||\nSDEILFQVYQPREPLHFSKFLDPDFQPSCSEVDLIGFVISVVKKTGLAPFVYLSDECYNLLAIKFWIDLNEDIIKPHMLI\n3121                                                                          3200\nAASNLQWRPESKSGLLTLFAGDFSVFSASPKEGHFQETFNKMKNTVENIDILCNEAENKLMHILHANDPKWSTPTKDCTS\n||||||||||||||| ||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||\nAASNLQWRPESKSGLPTLFAGDFSVFSASPKEGHFQETFNKMKNTVENIDILCNEAENKLMHILHANDPKWSTPTKDCTS\n3201                                                                          3280\nGPYTAQIIPGTGNKLLMSSPNCEIYYQSPLSLCMAKRKSVSTPVSAQMTSKSCKGEKEIDDQKNCKKRRALDFLSRLPLP\n||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||\nGPYTAQIIPGTGNKLLMSSPNCEIYYQSPLSLCMAKRKSVSTPVSAQMTSKSCKGEKEIDDQKNCKKRRALDFLSRLPLP\n3281                                                                          3360\nPPVSPICTFVSPAAQKAFQPPRSCGTKYETPIKKKELNSPQMTPFKKFNEISLLESNSIADEELALINTQALLSGSTGEK\n||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||\nPPVSPICTFVSPAAQKAFQPPRSCGTKYETPIKKKELNSPQMTPFKKFNEISLLESNSIADEELALINTQALLSGSTGEK\n3361                                                                          3440\nQFISVSESTRTAPTSSEDYLRLKRRCTTSLIKEQESSQASTEECEKNKQDTITTKKYI\n|||||||||||||||||||||||||| |||||||||||||||||||||||||||||||\nQFISVSESTRTAPTSSEDYLRLKRRC-TSLIKEQESSQASTEECEKNKQDTITTKKYI"
  },
  {
    "objectID": "Bioinfo.html#nussinov-rna-secondary-structure",
    "href": "Bioinfo.html#nussinov-rna-secondary-structure",
    "title": "Bioinformatics",
    "section": "Nussinov RNA Secondary Structure",
    "text": "Nussinov RNA Secondary Structure\nThe Nussinov algorithm predicts RNA secondary sturcture based on a global base-pairing score of a RNA sequence \\(S\\) with bases:\n\\[\nS_i \\in \\{A,U,G,C\\}\n\\]\nParings can occure between bases panning the subsequence \\(S_{i,j}\\) of a defined minimal length $|S(i,j)|_{min} \\ge L; L $ where L is the minmal loopsize which is at least one (base).\nThe optimal pairing score \\(S\\) between \\(i,j\\) is evaluated by following optimisation:\n\\[\nS(i,j) = max \\begin{cases}\nS(i+1,j-1) + w(i,j)  \\\\\nS(i+1,j) \\\\\nS(i,j-1) \\\\\nSmax_{i<k<j}S(i,k)+S(k+1,j) \\end{cases}\n\\]\nand stored in a Matrix \\(M\\) of dimensions \\(n, m = |S|\\) , with a zero diagonal as well as zero values at diagonals storing impossible pairings due loopsize.\nthe \\(w\\) function checks if the basepairs are complement\n\\[\nw(i,j)= 0; (i,j)\\in \\{(G,C),(A,U),((U,G))\\} \\implies 1\n\\]\nis implemented in following function complementary\n\ndef complementary(i,j, allowGU=False):\n    pair = (i,j)\n    comp = [(\"A\",\"U\"),(\"U\",\"A\"),(\"G\",\"C\"),(\"C\",\"G\")]\n    if allowGU:\n        comp.append((\"G\",\"U\"))\n        comp.append((\"U\",\"G\"))\n    if pair in comp:\n        return True\n    else:\n        return False\n\n\ndef OP(M,seq,loopsize):\n    for k in range(1,len(seq)):\n        for i in range(len(seq)-k):\n            j = i+k\n            if i >= j-loopsize:\n                M[i,j] = 0\n            else:\n                ij_paired = M[i+1,j-1] + complementary(seq[i],seq[j])\n                i_unpaired = M[i+1,j] # Si unpaired\n                j_unpaired = M[i,j-1] # Sj unpaired\n                decomp = max([M[i,k] + M[k+1,j] for k in range(i,j)])\n                M[i,j]= max(j_unpaired,i_unpaired,ij_paired,decomp)\n    return M\n\nTo determine the structure of the folded RNA by traceback, we first create an empty list of pairs P P. We initialize with i = 1 , j = n {i=1,j=n}. Then, we follow one of three scenarios.\nIf \\(j \\le i\\), the procedure stops. If \\(M (i,j) = M (i ,j − 1) M(i,j)=M(i,j-1)\\), then set \\(i=i , j =j-1\\) and continue.\nOtherwise, for all k : i ≤ k < j k:i k<j, if S k S_k and S j S_j are complementary and M ( i , j ) = M ( i , k − 1 ) + M ( k + 1 , j − 1 ) + 1 M(i,j)=M(i,k-1)+M(k+1,j-1)+1}, append ( k , j ) (k,j)} to P P, then traceback both with i = i , j = k − 1 i=i,j=k-1} and i = k + 1 , j = j − 1 i=k+1,j=j-1}.\nWhen the traceback finishes, P P contains all of the paired bases.\n\ndef traceback(i,j ,mat,seq,struc):\n    if j<i: return # : traceback finished!\n    elif mat[i,j] == mat[i+1,j]: # Rule 1\n        traceback(i+1,j,mat,seq,struc)\n    elif mat[i,j] == mat[i,j-1]: #Rule 2\n        traceback(i,j-1,mat,seq,struc)\n    elif mat[i,j] == mat[i+1,j-1] + complementary(seq[i],seq[j]): #Rule3\n        struc.append((i,j))\n        traceback(i+1,j-1,mat,seq,struc)\n    else:\n        for k in range(i,j):\n            if mat[i,j]== mat[i,k]+mat[k+1,j]:\n                traceback(i,k,mat,seq,struc)\n                traceback(k+1,j,mat,seq,struc)\n                break\n\nMain nussinov function:\n\nimport numpy as np\n\n\ndef Nussinov(sequence, loopsize):\n  header= str()\n  if sequence.startswith(\">\"):\n    header = ''.join(sequence.splitlines()[0])\n    sequence = ''.join(sequence.splitlines()[1:])\n  \n  length = len(sequence)\n  structure =[] # empty list to store structure\n  M = np.zeros((length,length),dtype=int)   # initialize matrix\n  OP(M,sequence,loopsize)   # fill score matrix \n  traceback(0,length-1,M,sequence,structure)  # tb through matrix\n  dots = [\".\"]*length # create dots notiation\n  for i in structure:\n    dots[min(i)]=\"(\"\n    dots[max(i)]=\")\"\n  return header+ '\\n' + sequence  + '\\n'+''.join(dots)\n\n\nfor i in range(1,4):\n   print( Nussinov(\"CCAGGAAAAUUAGG\",loopsize=i))\n\n\nCCAGGAAAAUUAGG\n((.)).((.))...\n\nCCAGGAAAAUUAGG\n((..)((..)).).\n\nCCAGGAAAAUUAGG\n(((..(...)).))\n\n\n\n\n\n\nhtrna=\"\"\">Human_tRNA_38.chr6 (Ile, AAT)\nGGCTGGTTAGTTCAGTTGGTTAGAGCGTGGTGCTAATAACGCCAAGGTCGTGGGTTCGATCCCCATATCGGCC\"\"\"\n\n\n#tRNA = ''.join(fasta.splitlines()[1:])\ntRNA=htrna.replace(\"T\",\"U\")\nstruct = Nussinov(tRNA,loopsize=6)\nprint(struct)\n\n>Human_tRNA_38.chr6 (Ile, AAU)\nGGCUGGUUAGUUCAGUUGGUUAGAGCGUGGUGCUAAUAACGCCAAGGUCGUGGGUUCGAUCCCCAUAUCGGCC\n(((..(..(..(.(..(((((.(.((((..(......))))))))(((((......))).)))))))))).))\n\n\n(((((((..((((………)))).(((((…….)))))…..(((((…….))))))))))))\n\nimport matplotlib.pyplot as plt\nimport forgi.visual.mplotlib as fvm\nimport forgi\nimport forgi.graph.bulge_graph as fgb"
  },
  {
    "objectID": "NumericalMethods.html",
    "href": "NumericalMethods.html",
    "title": "Numerical Differentiation",
    "section": "",
    "text": "As diferenças finitas são usadas em muitas técnicas numéricas. Por vezes não existe uma expressão para a função, apenas os seus valores numa grelha (ex.: dados experimentais, a continuar num próximo capítulo)\nFinite Differences are applied to many numerical techniques. For example if the expression for a function is unknown it can be approximated using …\nA ideia é usar a expansão em série de Taylor, para a frente e para trás, com passos de diferente dimensão, para obter a derivada da ordem pretendida (com menor ou maior precisão) Começa-se com, por exemplo:\n\\[\nf(x+h) = f(x) + hf'(x) + \\frac{h^2}{2!}f''(x)+\\frac{h³}{3!}f'''(x)+ …\n\\]\n\\[\nf(x+h) = \\sum_{n=1}^{N} \\frac{h^n}{n!}f^{n}(x) \\\\\nf(x-h) =  \\sum_{n=2}^{N} \\frac{h^n}{n!}f^n(x)- \\frac{h^{n+1}}{(n+1)!}f^{n+1}(x) \\\\\nf(x+2h) = \\sum_{n=0}^{N} \\frac{2h^n}{2n!}f^n(x) \\\\\nf(x-2h) = \\sum_{n=2}^{N} \\frac{2h^n}{n!}f^n(x)- \\frac{2h^{n+1}}{(n+1)!}f^{n+1}(x) \\\\\n\\]\n\n\n\n\\[\nf'(x) = \\frac{f(x+h)-f(x-h)}{2h} +O(h²) \\\\\nf''(x) = \\frac{f(x+h)-2f(x)+f(x-h)}{h²} + O(h^2) \\\\\nf'''(x) = \\frac{f(x+2h)-2f(x+h)+2f(x-h)-f(x-2h)}{2h} +O(h²) \\\\\nf^{(4)}(x) = \\frac{f(x+2h)-4f(x+h)+6f(x)-4f(x-h)+f(x-2h)}{h⁴} + O(h^2)  \\\\\neq:\\\\\nh^4 f^{(4)}(x) +O(h^6)= f(x+2h)-4f(x+h)+6f(x)-4f(x-h)+f(x-2h)\n\\]\nA soma e a subtração das expansões para a frente e para trás permitem eliminar alguns termos. São assim obtidas as diferentes derivadas, com uma precisão até certa ordemNo exemplo seguinte são eliminados os termos pares ou ímpares na ordem das derivadas\n\nf = lambda x : np.log2(x)\ndf = lambda x : 1/x\ndff = lambda x : -1/x**2\n\nx = np.linspace(1,60,60)\n\nplt.close()\nplt.plot(x,f(x),x,df(x),x,dff(x))\nplt.title(\"Function position as a function of time \\n $pos =  log(time)$\")\nplt.xlabel(\"time\")\nplt.ylabel(\"position | speed | acceleration \")\nplt.show()\n\n\n\n\n\na = [(f(x+0.5)-f(x))/0.5 for x in x]\na2 = [(f(x+0.5)-f(x-0.5))/2*0.5 for x in x]\na4 = [(-f(x+2*0.5)+8*f(x+0.5)-8*f(x-0.5)+f(x-2*0.5))/12*0.5 for x in x]\nplt.close()\nplt.plot(x,df(x),x,a,x,a2, x,a4)\nplt.title(\"approximation of acceleration function df\")\nplt.show()\n\n/tmp/ipykernel_111243/1142847347.py:1: RuntimeWarning: divide by zero encountered in log2\n  f = lambda x : np.log2(x)\n\n\n\n\n\n\n\n\n$$ f(x) = e^{-x} ;   x = 1 \\ f’(x) = -e^{-x} \\ f’’(x) = e^{-x}\nf’’(x)_{approx} = \n$$\n\n#f = lambda x : np.exp(-x)\n#df = lambda x : -np.exp(x)\n\n\n#dfapp = lambda x : (f(x+h)-2*f(x)+f(x-h))/h**2 \n#plt.close()\n#plt.plot(x,dfapp)\n#plt.show()\n\n\n\n\n\\[\n\\int_{1}^{∞}\\frac{1}{1+x^4}  dx\n\\] e compare o resultado obtido com o valor “exato” 0,24375. Ajuda: use a mudança de variável x3 = 1/t .\n#| standalone: true\n#| eval: false\n#| viewerHeight: 420\n\nfrom shiny import App, render, ui\nimport numpy as np\nimport matplotlib.pyplot as plt\n\napp_ui = ui.page_fluid(\n    ui.layout_sidebar(\n        ui.panel_sidebar(\n            ui.input_slider(\"period\", \"Period\", 0.5, 2, 1, step=0.5),\n            ui.input_slider(\"amplitude\", \"Amplitude\", 0, 2, 1, step=0.25),\n            ui.input_slider(\"shift\", \"Phase shift\", 0, 2, 0, step=0.1),\n        ),\n        ui.panel_main(\n            ui.output_plot(\"plot\"),\n        ),\n    ),\n)\n\n\ndef server(input, output, session):\n    @output\n    @render.plot(alt=\"Sine function\")\n    def plot():\n        t = np.arange(0.0, 4.0, 0.01)\n        s = input.amplitude() * np.sin(\n            (2 * np.pi / input.period()) * (t - input.shift() / 2)\n        )\n        fig, ax = plt.subplots()\n        ax.set_ylim([-2, 2])\n        ax.plot(t, s)\n        ax.grid()\n\n\napp = App(app_ui, server)\n\nviewof amount = Inputs.range([0, 100], {label: \"Amount\", step: 1})"
  },
  {
    "objectID": "conway.html",
    "href": "conway.html",
    "title": "Conway’s Game of live",
    "section": "",
    "text": "Conways game of life is a basic cellular automata simulation. In this gridbased simulation the state of a cell, dead or alive, is defined by the number of its direct neigbors:\nShinylive"
  },
  {
    "objectID": "conway.html#python-implementation",
    "href": "conway.html#python-implementation",
    "title": "Conway’s Game of live",
    "section": "Python Implementation",
    "text": "Python Implementation\nThe function create_grid returns a 2d array of specified dimensions.\n\ndef create_grid(xdim,ydim):return( [[x]*xdim for x in [0]* ydim] )\n\nTo count living cells in the neighbourhood of all cells the function neighbors creates an other grid that stores the counts for each cell in the grid.\n\ndef neigbors(grid):\n  neib = create_grid(xdim,ydim)\n  for i in range(ydim):\n    for j in range(xdim):\n      for y in range(i-1,i+2):\n        for x in range(j-1,j+2):\n          neib[i][j] += grid[y%ydim][x%xdim]\n      neib[i][j] = neib[i][j]-grid[i][j]\n  return(neib)\n\nThe step function iterates through the grid and gives birth or kills cells based oon their neigbourhood.\n\ndef step(grid):\n  neibs = neigbors(grid)\n  for i in range(ydim):\n    for j in range(xdim):\n      if grid[i][j] == 1:\n        if neibs[i][j] in [2,3]:\n          grid[i][j] = 1\n        else:\n          grid[i][j] = 0\n      else:\n        if neibs[i][j] == 3:\n          grid[i][j] = 1\n  return(grid)\n\nTo populate our World the populate fuction adds living cells at defined locations in the grid, specified by an array of coordinate tuples.\n\ndef populate(grid,coord_array):\n    coord_range = [(y, x) for y in range(ydim) for x in range(xdim)] \n    for (y,x) in coord_range:\n        if (y,x) in coord_array:\n            grid[y][x]=1\n    return(grid)\n\nThe coord_array are stored in a dict called creatures:\n\n\nCode\ncreatures = {\n  \"glider\" : [(0,1),(1,2),(2,0),(2,1),(2,2),(10,1),(11,2),(12,0),(12,1),(12,2)],\n  \"blinker\" : [(10,10),(10,11),(10,12)],\n  \"ggun\" :[(5,1),(5,2),(6,1),(6,2),(5,11),(6,11),(7,11),(4,12),(8,12),(3,13),(9,13),\n  (3,14),(9,14),(6,15),(4,16),(8,16),(5,17),(6,17),(7,17),(6,18),(3,21),(4,21),\n  (5,21),(3,22),(4,22),(5,22),(2,23),(6,23),(2,25),(7,25),(1,25),(6,25),(3,35),(4,35),(3,36),(4,36)]\n}\n\n\nTo obtain a quick visualisation of the world, the Vis function creates a string from the grid.\n\ndef Vis(grid):\n    vis = str()\n    for y in range(ydim):\n        for x in range(xdim):\n            if grid[y][x] == 0: vis += '░' \n            else: vis += '█'\n        vis += '\\n'\n    return vis\n\nFinally the main function runs the simualtion loop and returns the visualisation.\n\ndef main(xdim,ydim,steps,creature):\n    grid = create_grid(xdim,ydim)\n    visus = []\n    populate(grid,creatures[creature])\n    for s in range(1,steps):\n        visus.append(Vis(step(grid)))\n    return(visus)"
  }
]